{% extends 'dashboard.html' %}
{% load static %}
{% load item_tags %}
{% load widget_tweaks %}
 
{% block require %}
    <script src="{% static 'js/require.js' %}"   data-main="{% static 'js/common2.js' %}"></script>


    <script>
        require(['script/ajax-quizz']);
        require(['script/ajax-quizz-complement']);
    </script> 

{% endblock %}



{% block page_title %}
        <a href="{% url 'index' %}" ><i class="fa fa-cubes"></i> Les quizz</a> 
{% endblock %}

{% block page_menu_right %}

     <a href="#" data-toggle='modal' data-target='#quizz_choice'  class="btn btn-new pull-right">  Créer un quizz</a>  

{% endblock %}




{% block body %}
<section class="content_main"> 
    <div class="row">
        <div class="col-sm-12 col-md-12">
            <table id="standard_tab" class="table table-bordered table-hover">
                <thead>
                <tr>
                    <th>Titre</th>
                    <th>Code <span class="sacado">SACADO Quizz Play</span></th>
                    <th>Groupes attribués</th>
                    <th>  </th>
                </tr>
                </thead>
                <tbody>
                    {% for quizz in quizzes %}
                        <tr>
                            <td style="line-height: 200px">
                               <a href="{% url 'update_quizz' quizz.id  %}"> {% if quizz.vignette %}<img src="{{ quizz.vignette.url }}" width="200px" />{% endif %}{{ quizz.title }}</a>
                               {% if quizz.is_random %}

                                <span class="helper_tip"  style="line-height: 30px"> <i class="fa fa-random" style="font-size:12px"></i> 
                                    <div class="helper_tip_text" >Questions aléatoires </div>
                                </span> 
                               {% endif %}





                            </td>
                            <td style="line-height: 200px; font-size:30px">
                                 {{ quizz.code }}  
                            </td>
                            <td style="line-height: 200px"> 
                                {% for g in quizz.groups.all %} {{ g }} {% if not forloop.last %}, {% endif %} {% endfor %}
                            </td>
                            <td > 
                                <div class="quizz_action"><a href="{% url 'create_question'  quizz.id 0 %}" ><i class="fa fa-plus"></i> Ajouter des questions</a> 
                                    <span style="font-size:10px"> 
                                        <b>{% if quizz.is_random %}
                                        {{ quizz.qrandoms.count }}
                                        {% else %}
                                        {{ quizz.questions.count }}
                                        {% endif  %} question{% if quizz.qrandoms.count > 1 or quizz.questions.count > 1 %}s{% endif %}</b>
                                    </span>
                                </div>  
                                {% if quizz.qrandoms.count > 0 or quizz.questions.count > 0 %}
                                <div class="quizz_action"><a href="{% url 'play_printing_teacher'  quizz.id   %}"  class="quizz_action"><i class="fa fa-print"></i> Créer les fiches réponses imprimables</a> </div>    
                                <div class="quizz_action"><a href="{% url 'play_quizz_teacher'  quizz.id   %}" target="_blank"  class="quizz_action"><i class="fa fa-play"></i> <em> Mode jeu</em></a> A venir  </div>   
                                <div class="quizz_action">
                                    <a href="{% if quizz.is_random %}{% url 'show_quizz_random'  quizz.id %}{% else %}{% url 'show_quizz'  quizz.id %}{% endif %}" 
                                        class="quizz_action"><i class="fa fa-eye"></i>  Mode présentation</a>  
                                </div> 
                                {% else  %}
                                <div class="alert alert-danger"><br/>Aucune question actuellement<br/> <br/></div> 
                                {% endif  %}
                                <div class="quizz_action"><a href="{% url 'delete_quizz'  quizz.id %}"  class="quizz_action"  onclick="return TestDelete('ce quizz')"><i class="fa fa-trash"></i>  Supprimer</a> </div>  
                            </td>
                        </tr>
                    {% endfor %} 
                </tbody>
            </table>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12 col-md-12">     
                <a href="javascript:history.back()"  class="btn btn-default " >Retour </a>
        </div>
    </div>
</section>


<div class="modal fade" id="quizz_choice" tabindex="-1" role="dialog" aria-labelledby="quizz_choice">
    <div class="modal-dialog" role="document" style="width: 750px;">
        <div class="modal-content" >
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button> 
                <h1 class='thin'  >Création du quizz</h1>
            </div>
            <div class="modal-body">
                <form action="{% url 'create_quizz' %}" method="POST"  enctype='multipart/form-data'>
 
                    {% include 'tool/form_quizz_items.html' %}
                </form>
            </div>
        </div>
    </div>
</div>

{% endblock %}