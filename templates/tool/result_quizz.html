{% extends 'dashboard.html' %}
{% load static %}
{% load item_tags %}
{% load widget_tweaks %}
 
{% block require %}
    <script src="{% static 'js/require.js' %}"   data-main="{% static 'js/common2.js' %}"></script>
    <script>
        require(['script/ajax-quizz-complement']);
    </script> 
{% endblock %}


{% block page_title %}
    <a href="{% url 'list_quizzes' %}" ><i class="fa fa-cubes"></i> Résultats</a>  <img width="25px" src="{% static 'img/angle-right.png' %}"/> {{ gquizz.quizz.title}} <img width="25px" src="{% static 'img/angle-right.png' %}"/> 
    <small>{{ gquizz.quizz.code}}</small>
{% endblock %}



{% block page_menu_right %}
    <a href="{% url 'list_quizzes' %}" class="btn btn-new pull-right">Mes quizz</a>  
{% endblock %}


{% block body %} 
<section class="content_main">

    <div class="row">
        <div class="col-sm-12 col-md-12">
            <a id="display_init" class="btn btn-default"> Afficher/cacher les résultats par élève</a>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12 col-md-8">
            {% for question in questions %}
            <div class="row">    
                <div class="card" style="padding:15px; width:90%">

                {% get_success_percent question gquizz as percent_success %}
                <h4 >Question {{ forloop.counter }}. <span class="pull-right">{{ percent_success }}</span> </h4>
                {{ question.title|safe }}
                </div> 
                <div class="col-sm-12 col-md-12 no_display_init">
                {% for student in gquizz.group.students.all|dictsort:"user.last_name" %}
 
                    {% get_real_ans_for_this_question  question  gquizz  student as dict_answer %} 
                    <span class="btn btn-{% if dict_answer.is_correct %}success{% else %}danger{% endif %}">{{ student.user }}
                        <small>
                        {% if question.qtype < 3 %} 
                            {{ dict_answer.answer }} 
                        {% else %}
                            {% for a in dict_answer.answer %}
                                {{ a }}  
                                {% if not forloop.last %}<br/>{% endif %}
                            {% endfor %}
                        {% endif %}
                        </small>
                    
                    </span>    
                {% endfor %}
                </div>
            </div>
            <hr/>
            {% endfor %}
        </div>
        <div class="col-sm-12 col-md-4 no_display_init">
            <table  class="table table-bordered table-hover standard_tab_sort">
                <thead>
                <tr>
                    <th>Nom</th>
                    <th>Score</th>
                    <th> </th>
                </tr>
                </thead>
                <tbody>
                    {% for student in gquizz.group.students.all|dictsort:"user.last_name" %}
                    {% get_score_quizz  student gquizz as data_global %}
                        <tr>
                            <td>{{ student.user }}</td>
                            <td style="text-align: center;"><b>{{ data_global.score  }}</b> / {{ questions.count}}</td>
                            <td style="text-align: center;">{{ data_global.percent  }}%</td>
                        </tr>
                    {% endfor %}
            </table>

        </div>
    </div>
</section>
{% endblock %}  

 