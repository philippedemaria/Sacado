{% extends 'dashboard.html' %}
{% load widget_tweaks %}
{% load static %}


{% block require %}
 
    {% if group %}
    <script src="{% static 'js/require.js' %}"   data-main="{% static 'js/common3.js' %}"></script>
    {% else %}
    <script src="{% static 'js/require.js' %}"   data-main="{% static 'js/common2.js' %}"></script>
    {% endif %}

    <script>
        require(['script/ajax-group']);
    </script>
 
 
{% endblock %}


{% block page_title %}  
    <i class='fa fa-users'></i>  {% if group %}<span style="color:{{group.color }}" > {{ group }}</span> {% else %} Groupe    <img src="{% static 'img/angle-right.png' %}"/> <small>Nouveau</small> {% endif %}  
{% endblock %}

{% block page_menu_right %}
    



        <li><a href="{% url 'create_parcours' %}" class="btn btn-new" ><i class="fa fa-plus"></i>  Nouveau parcours </a> </li>


    
{% endblock %}


 


 
     
{% block body %}     
<div class="content_main">
    <div class="row">
        <div class="col-sm-12 col-md-4">
            <form action="" method="POST">
            {% csrf_token %}
                <div class="row">
                    <div class="col-sm-12 col-md-5">
                        <div class="form-group">
                            {{ form.name.label_tag }} <font style="font-size:12px">18 lettres max.</font>
                            {{ form.name |add_class:"form-control" }}
                            {{ form.name.errors }}
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-7">
                        <div class="form-group">
                            {{ form.level.label_tag }}
                            {{ form.level |add_class:"form-control select2" }}
                            {{ form.level.errors }}
                        </div>
                    </div>
                </div> 
                <div class="row">
                    <div class="col-sm-12 col-lg-2">
                          {{ form.color.label_tag }}
                          <div id="color-picker-component" class="input-group colorpicker-component">
                              {{ form.color.as_hidden }}
                              <span class="input-group-addon"><i></i></span>
                          </div>
                    </div>
 
                    <div class="col-sm-12 col-md-6">
                           <label>Associer tous les exercices ?</label> <br>
                            {{ form.assign  |attr:"data-toggle:toggle" |attr:"data-onstyle:primary"|attr:"data-offstyle:default"|attr:"data-on:Oui"|attr:"data-off:Non"}}
                    </div>
                     <div class="col-sm-12 col-md-4">
                           <label>Suivi parent ?</label> <br>
                            {{ form.suiviparent  |attr:"data-toggle:toggle" |attr:"data-onstyle:primary"|attr:"data-offstyle:default"|attr:"data-on:Oui"|attr:"data-off:Non"}}
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <div class="form-group">
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <div class="form-group">
                            <label>Elèves <small>(Optionnel)<em> L'adresse mail est facultative.</em> <span style="color:#cb2131">1 élève par ligne. <br/>Le mot de passe par défaut est : sacado2020</span></small></label> <br> 
                            <textarea name="students" id="students_id"  style="border:1px #CCC solid" class="form-control" rows="10" placeholder="Alan;Turing;alan.turing@enigma.com"></textarea>
                        </div>
                    </div>
                </div> 
 

                <div class="row">
                    <div class="col-sm-12 col-md-6">
                        <div class="form-group">
                            <input value="Enregistrer" type="submit" class="btn btn-sacado"  id="test_students"  />
                            <a href="javascript:history.back()"><input type="button" value="Annuler"
                                                                       class="btn btn-default "/></a>
                        </div>
                    </div>
                


                {% if group %}

                    <div class="col-sm-12 col-md-4">
                        <div class="form-group">
                            <a href="{% url 'delete_group' group.id %}" class="btn btn-danger" onclick="return TestDelete('ce groupe')">Supprimer ce groupe</a>
                        </div>
                    </div>

                {% endif %}
                </div>

                {% if group %}
                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <div style="font-size: 14px">
                            Les élèves peuvent rejoindre ce groupe dès que vous leur avez communiqué cette URL : <strong>http://parcours.erlm.tn/group/{{ group.code }}</strong>. <br>Ils peuvent aussi s’inscrire à l’adresse <strong>http://parcours.erlm.tn/#students</strong> et utiliser le code suivant : <strong>{{ group.code }}</strong>
                        </div>
                    </div>

                </div>
                {% endif %}
            </form>
        </div>
        <div class="col-sm-12 col-md-8">
            <table class="table table-striped table-hover display50">
                <thead> 
                <tr>
                    <th>Nom <span data-container="body"
                                    data-toggle="popover"
                                    data-trigger="hover"
                                    data-content="Pour modifier le nom, le prénom, le courriel, l'identifiant, écrire directement à la place souhaitée. Enregistrement automatique.">
                                    <i class="fa fa-question-circle"></i>
                            </span>
                    </th>
                    <th>
                        Prénom
                    </th>
                    <th>
                        Courriel 
                    </th>
                    <th>
                        Identifiant  
                    </th>
                </tr>
                </thead>
                <tbody>
                {% for student in group.students.all|dictsort:"user.last_name" %}
                    <form action="" method="POST">
                    <tr>
                        <td><input  type="text" 
                                    id="studentLastName{{ student.user.id }}" 
                                    data-student_id="{{ student.user.id }}" 
                                    class="updateStudent" 
                                    data-is_name="1" 
                                    value="{{ student.user.last_name|lower|title }}" 
                                    style="background: transparent; border: none;width:140px" /> 
                        </td>
                        <td><input  type="text" 
                                    id="studentFirstName{{ student.user.id }}" 
                                    data-student_id="{{ student.user.id }}" 
                                    data-is_name="0" 
                                    class="updateStudent"  
                                    value="{{ student.user.first_name|lower|title }}" 
                                    style="background: transparent; border: none;width:140px" /> 
                        </td>
                        <td><input  type="text" 
                                    id="studentEmail{{ student.user.id }}" 
                                    data-student_id="{{ student.user.id }}" 
                                    data-is_name="2" 
                                    class="updateStudent"  
                                    value="{{ student.user.email }}" 
                                    style="background: transparent; border: none;width:200px" /> </td>
                        <td><input  type="text" 
                                    id="studentUsername{{ student.user.id }}" 
                                    data-student_id="{{ student.user.id }}" 
                                    data-is_name="3" 
                                    class="updateStudent"  
                                    value="{{ student.user.username }}" 
                                    style="background: transparent; border: none;width:140px" />
 
                            <a  href="{% url 'delete_student' student.user.id  group.id %}"  class="pull-right"
                                onclick="return TestDelete('cet élève')" style="font-size:14px"  >
                                <i class="fa fa-trash"></i>
                            </a> 

                            <a  href="{% url 'newpassword_student' student.user.id  group.id   %}"  class="pull-right" data-student_id="{{ student.user.id }}" 
                                onclick="return Newpassword()" style="font-size:14px; margin-right:5px"  >
                                <i class="fa fa-refresh"></i>
                            </a>  


                        </td>
                    </tr>
                    </form>
                {% empty %}
                    <tr>
                        <td><div class="alert alert-danger">Aucun élève inséré.</div></td>
                        <td></td><td></td><td></td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div> 


    <div class="modal fade bd-example-modal-lg" id="help"  tabindex="-1" role="dialog" aria-labelledby="help" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document" style="margin:0px!important">
 
            {% if user.user_type == 2 %}
                <div class="modal-content help" >
 
                    <div class="helpdiv_help_title_page"  style="left:500px;">
                        titre de page
                    </div>
                    <div class="helpdiv_help_groupe"   style="top:130px;left:160px;width:500px">
                         Nom du groupe obligatoire <span style="margin-left:50px">Niveau obligatoire</span>
                         <br><br><br><br> <span style="margin-left:150px;text-align: right">Suivi parent : cocher oui si vous voulez que les</span>
                        <br> <span style="margin-left:150px;text-align: right">parents de vos élèves accèdent à leurs résultats</span>
    <br> <span style="margin-left:150px;text-align: right">Ils devront s'inscrire et se lier à leur enfants.</span>
                        
                    </div>


                    <div class="helpdiv_help_acces"  style="top:45px;right:50px; padding:10px">
                       Nouveau parcours lié à ce groupe <img src="{% static 'img/fleche_up_right.png' %}" width="40px" style="vertical-align:bottom" />
                    </div>



                    <div class="helpdiv_help_list_group">
                        <div class="help_list_group">
                            {% if group %}    <img src="{% static 'img/fleche_up_left.png' %}" width="40px" style="vertical-align:bottom" />Lien à donner aux élèves {% endif %}  
                            <br><br>Liste des élèves. <br>Modification directe par réécriture dans les champs des noms, prénomns, courriels, identifiants. 
                            <br><i class="fa fa-trash"></i> Supprimer un élève 
                            <br><i class="fa fa-refresh"></i> Ré-initialiser son mot de passe : sacado2020  
                        </div>
                         <br> <br><img src="{% static 'img/fleche_up_right.png' %}" width="40px" /><br><br><img src="{% static 'img/fleche_bottom_right.png' %}" width="40px" style="vertical-align:middle;"/>

                    </div>
       


                </div>
            {% endif %}
        </div>
    </div>    
{% endblock %}